//     Underscore.js 1.7.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function(){var a=this,b=a._,c=Array.prototype,d=Object.prototype,e=Function.prototype,f=c.push,g=c.slice,h=c.concat,i=d.toString,j=d.hasOwnProperty,k=Array.isArray,l=Object.keys,m=e.bind,n=function(a){return a instanceof n?a:this instanceof n?void(this._wrapped=a):new n(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):a._=n,n.VERSION="1.7.0";var o=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}};n.iteratee=function(a,b,c){return null==a?n.identity:n.isFunction(a)?o(a,b,c):n.isObject(a)?n.matches(a):n.property(a)},n.each=n.forEach=function(a,b,c){if(null==a)return a;b=o(b,c);var d,e=a.length;if(e===+e)for(d=0;e>d;d++)b(a[d],d,a);else{var f=n.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},n.map=n.collect=function(a,b,c){if(null==a)return[];b=n.iteratee(b,c);for(var d,e=a.length!==+a.length&&n.keys(a),f=(e||a).length,g=Array(f),h=0;f>h;h++)d=e?e[h]:h,g[h]=b(a[d],d,a);return g};var p="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(a,b,c,d){null==a&&(a=[]),b=o(b,d,4);var e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length,h=0;if(arguments.length<3){if(!g)throw new TypeError(p);c=a[f?f[h++]:h++]}for(;g>h;h++)e=f?f[h]:h,c=b(c,a[e],e,a);return c},n.reduceRight=n.foldr=function(a,b,c,d){null==a&&(a=[]),b=o(b,d,4);var e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;if(arguments.length<3){if(!g)throw new TypeError(p);c=a[f?f[--g]:--g]}for(;g--;)e=f?f[g]:g,c=b(c,a[e],e,a);return c},n.find=n.detect=function(a,b,c){var d;return b=n.iteratee(b,c),n.some(a,function(a,c,e){return b(a,c,e)?(d=a,!0):void 0}),d},n.filter=n.select=function(a,b,c){var d=[];return null==a?d:(b=n.iteratee(b,c),n.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d)},n.reject=function(a,b,c){return n.filter(a,n.negate(n.iteratee(b)),c)},n.every=n.all=function(a,b,c){if(null==a)return!0;b=n.iteratee(b,c);var d,e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,!b(a[e],e,a))return!1;return!0},n.some=n.any=function(a,b,c){if(null==a)return!1;b=n.iteratee(b,c);var d,e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,b(a[e],e,a))return!0;return!1},n.contains=n.include=function(a,b){return null!=a&&(a.length!==+a.length&&(a=n.values(a)),n.indexOf(a,b)>=0)},n.invoke=function(a,b){var c=g.call(arguments,2),d=n.isFunction(b);return n.map(a,function(a){return(d?b:a[b]).apply(a,c)})},n.pluck=function(a,b){return n.map(a,n.property(b))},n.where=function(a,b){return n.filter(a,n.matches(b))},n.findWhere=function(a,b){return n.find(a,n.matches(b))},n.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b&&null!=a){a=a.length===+a.length?a:n.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=n.iteratee(b,c),n.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},n.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=a.length===+a.length?a:n.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=n.iteratee(b,c),n.each(a,function(a,c,d){e=b(a,c,d),(g>e||1/0===e&&1/0===f)&&(f=a,g=e)});return f},n.shuffle=function(a){for(var b,c=a&&a.length===+a.length?a:n.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=n.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},n.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=n.values(a)),a[n.random(a.length-1)]):n.shuffle(a).slice(0,Math.max(0,b))},n.sortBy=function(a,b,c){return b=n.iteratee(b,c),n.pluck(n.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var q=function(a){return function(b,c,d){var e={};return c=n.iteratee(c,d),n.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};n.groupBy=q(function(a,b,c){n.has(a,c)?a[c].push(b):a[c]=[b]}),n.indexBy=q(function(a,b,c){a[c]=b}),n.countBy=q(function(a,b,c){n.has(a,c)?a[c]++:a[c]=1}),n.sortedIndex=function(a,b,c,d){c=n.iteratee(c,d,1);for(var e=c(b),f=0,g=a.length;g>f;){var h=f+g>>>1;c(a[h])<e?f=h+1:g=h}return f},n.toArray=function(a){return a?n.isArray(a)?g.call(a):a.length===+a.length?n.map(a,n.identity):n.values(a):[]},n.size=function(a){return null==a?0:a.length===+a.length?a.length:n.keys(a).length},n.partition=function(a,b,c){b=n.iteratee(b,c);var d=[],e=[];return n.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},n.first=n.head=n.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:g.call(a,0,b)},n.initial=function(a,b,c){return g.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},n.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:g.call(a,Math.max(a.length-b,0))},n.rest=n.tail=n.drop=function(a,b,c){return g.call(a,null==b||c?1:b)},n.compact=function(a){return n.filter(a,n.identity)};var r=function(a,b,c,d){if(b&&n.every(a,n.isArray))return h.apply(d,a);for(var e=0,g=a.length;g>e;e++){var i=a[e];n.isArray(i)||n.isArguments(i)?b?f.apply(d,i):r(i,b,c,d):c||d.push(i)}return d};n.flatten=function(a,b){return r(a,b,!1,[])},n.without=function(a){return n.difference(a,g.call(arguments,1))},n.uniq=n.unique=function(a,b,c,d){if(null==a)return[];n.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=n.iteratee(c,d));for(var e=[],f=[],g=0,h=a.length;h>g;g++){var i=a[g];if(b)g&&f===i||e.push(i),f=i;else if(c){var j=c(i,g,a);n.indexOf(f,j)<0&&(f.push(j),e.push(i))}else n.indexOf(e,i)<0&&e.push(i)}return e},n.union=function(){return n.uniq(r(arguments,!0,!0,[]))},n.intersection=function(a){if(null==a)return[];for(var b=[],c=arguments.length,d=0,e=a.length;e>d;d++){var f=a[d];if(!n.contains(b,f)){for(var g=1;c>g&&n.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},n.difference=function(a){var b=r(g.call(arguments,1),!0,!0,[]);return n.filter(a,function(a){return!n.contains(b,a)})},n.zip=function(a){if(null==a)return[];for(var b=n.max(arguments,"length").length,c=Array(b),d=0;b>d;d++)c[d]=n.pluck(arguments,d);return c},n.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},n.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=n.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}for(;e>d;d++)if(a[d]===b)return d;return-1},n.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=a.length;for("number"==typeof c&&(d=0>c?d+c+1:Math.min(d,c+1));--d>=0;)if(a[d]===b)return d;return-1},n.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var s=function(){};n.bind=function(a,b){var c,d;if(m&&a.bind===m)return m.apply(a,g.call(arguments,1));if(!n.isFunction(a))throw new TypeError("Bind must be called on a function");return c=g.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(g.call(arguments)));s.prototype=a.prototype;var e=new s;s.prototype=null;var f=a.apply(e,c.concat(g.call(arguments)));return n.isObject(f)?f:e}},n.partial=function(a){var b=g.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===n&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},n.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=n.bind(a[c],a);return a},n.memoize=function(a,b){var c=function(d){var e=c.cache,f=b?b.apply(this,arguments):d;return n.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},n.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},n.defer=function(a){return n.delay.apply(n,[a,1].concat(g.call(arguments,1)))},n.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:n.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=n.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},n.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=n.now()-g;b>j&&j>0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=n.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},n.wrap=function(a,b){return n.partial(b,a)},n.negate=function(a){return function(){return!a.apply(this,arguments)}},n.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},n.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},n.before=function(a,b){var c;return function(){return--a>0?c=b.apply(this,arguments):b=null,c}},n.once=n.partial(n.before,2),n.keys=function(a){if(!n.isObject(a))return[];if(l)return l(a);var b=[];for(var c in a)n.has(a,c)&&b.push(c);return b},n.values=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},n.pairs=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},n.invert=function(a){for(var b={},c=n.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},n.functions=n.methods=function(a){var b=[];for(var c in a)n.isFunction(a[c])&&b.push(c);return b.sort()},n.extend=function(a){if(!n.isObject(a))return a;for(var b,c,d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)j.call(b,c)&&(a[c]=b[c])}return a},n.pick=function(a,b,c){var d,e={};if(null==a)return e;if(n.isFunction(b)){b=o(b,c);for(d in a){var f=a[d];b(f,d,a)&&(e[d]=f)}}else{var i=h.apply([],g.call(arguments,1));a=new Object(a);for(var j=0,k=i.length;k>j;j++)d=i[j],d in a&&(e[d]=a[d])}return e},n.omit=function(a,b,c){if(n.isFunction(b))b=n.negate(b);else{var d=n.map(h.apply([],g.call(arguments,1)),String);b=function(a,b){return!n.contains(d,b)}}return n.pick(a,b,c)},n.defaults=function(a){if(!n.isObject(a))return a;for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)void 0===a[e]&&(a[e]=d[e])}return a},n.clone=function(a){return n.isObject(a)?n.isArray(a)?a.slice():n.extend({},a):a},n.tap=function(a,b){return b(a),a};var t=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof n&&(a=a._wrapped),b instanceof n&&(b=b._wrapped);var e=i.call(a);if(e!==i.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]===a)return d[f]===b;var g=a.constructor,h=b.constructor;if(g!==h&&"constructor"in a&&"constructor"in b&&!(n.isFunction(g)&&g instanceof g&&n.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var j,k;if("[object Array]"===e){if(j=a.length,k=j===b.length)for(;j--&&(k=t(a[j],b[j],c,d)););}else{var l,m=n.keys(a);if(j=m.length,k=n.keys(b).length===j)for(;j--&&(l=m[j],k=n.has(b,l)&&t(a[l],b[l],c,d)););}return c.pop(),d.pop(),k};n.isEqual=function(a,b){return t(a,b,[],[])},n.isEmpty=function(a){if(null==a)return!0;if(n.isArray(a)||n.isString(a)||n.isArguments(a))return 0===a.length;for(var b in a)if(n.has(a,b))return!1;return!0},n.isElement=function(a){return!(!a||1!==a.nodeType)},n.isArray=k||function(a){return"[object Array]"===i.call(a)},n.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},n.each(["Arguments","Function","String","Number","Date","RegExp"],function(a){n["is"+a]=function(b){return i.call(b)==="[object "+a+"]"}}),n.isArguments(arguments)||(n.isArguments=function(a){return n.has(a,"callee")}),"function"!=typeof/./&&(n.isFunction=function(a){return"function"==typeof a||!1}),n.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},n.isNaN=function(a){return n.isNumber(a)&&a!==+a},n.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===i.call(a)},n.isNull=function(a){return null===a},n.isUndefined=function(a){return void 0===a},n.has=function(a,b){return null!=a&&j.call(a,b)},n.noConflict=function(){return a._=b,this},n.identity=function(a){return a},n.constant=function(a){return function(){return a}},n.noop=function(){},n.property=function(a){return function(b){return b[a]}},n.matches=function(a){var b=n.pairs(a),c=b.length;return function(a){if(null==a)return!c;a=new Object(a);for(var d=0;c>d;d++){var e=b[d],f=e[0];if(e[1]!==a[f]||!(f in a))return!1}return!0}},n.times=function(a,b,c){var d=Array(Math.max(0,a));b=o(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},n.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},n.now=Date.now||function(){return(new Date).getTime()};var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},v=n.invert(u),w=function(a){var b=function(b){return a[b]},c="(?:"+n.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};n.escape=w(u),n.unescape=w(v),n.result=function(a,b){if(null!=a){var c=a[b];return n.isFunction(c)?a[b]():c}};var x=0;n.uniqueId=function(a){var b=++x+"";return a?a+b:b},n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},A=/\\|'|\r|\n|\u2028|\u2029/g,B=function(a){return"\\"+z[a]};n.template=function(a,b,c){!b&&c&&(b=c),b=n.defaults({},b,n.templateSettings);var d=RegExp([(b.escape||y).source,(b.interpolate||y).source,(b.evaluate||y).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(A,B),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(a){throw a.source=f,a}var h=function(a){return g.call(this,a,n)},i=b.variable||"obj";return h.source="function("+i+"){\n"+f+"}",h},n.chain=function(a){var b=n(a);return b._chain=!0,b};var C=function(a){return this._chain?n(a).chain():a};n.mixin=function(a){n.each(n.functions(a),function(b){var c=n[b]=a[b];n.prototype[b]=function(){var a=[this._wrapped];return f.apply(a,arguments),C.call(this,c.apply(n,a))}})},n.mixin(n),n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=c[a];n.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],C.call(this,c)}}),n.each(["concat","join","slice"],function(a){var b=c[a];n.prototype[a]=function(){return C.call(this,b.apply(this._wrapped,arguments))}}),n.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return n})}).call(this),/**
 * History.js Core
 * @author Benjamin Arthur Lupton <contact@balupton.com>
 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
 */
function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;try{f=a.sessionStorage,f.setItem("TEST","1"),f.removeItem("TEST")}catch(a){f=!1}if(k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init)throw new Error("History.js Core has already been loaded...");m.init=function(a){return"undefined"!=typeof m.Adapter&&("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)},m.initCore=function(o){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.disableSuid=m.options.disableSuid||!1,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.options.html4Mode=m.options.html4Mode||!1,m.options.delayInit=m.options.delayInit||!1,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a,b,e,f,g,h="undefined"!=typeof c&&"undefined"!=typeof c.log&&"undefined"!=typeof c.log.apply,i=d.getElementById("log");for(h?(f=Array.prototype.slice.call(arguments),a=f.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[a,f]):c.log.apply(c,[a,f])):a="\n"+arguments[0]+"\n",b=1,e=arguments.length;b<e;++b){if(g=arguments[b],"object"==typeof g&&"undefined"!=typeof k)try{g=k.stringify(g)}catch(a){}a+="\n"+g+"\n"}return i?(i.value+=a+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):h||l(a),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4&&a}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.options.html4Mode?m.emulated={pushState:!0,hashChange:!0}:m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a,b=m.getState(!1,!1),c=(b||{}).url||m.getLocationHref();return a=c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a,b,c){return/\./.test(a)?a:a+"/"})},m.getBasePageUrl=function(){var a=m.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a,b,c){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b="undefined"==typeof b||b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},m.getLocationHref=function(a){return a=a||d,a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash?a.location.href:a.URL.indexOf("#")==-1&&a.location.href.indexOf("#")!=-1?a.location.href:a.URL||a.location.href},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b,c=m.extractId(a.url);if(!c)if(b=m.getStateString(a),"undefined"!=typeof m.stateToId[b])c=m.stateToId[b];else if("undefined"!=typeof m.store.stateToId[b])c=m.store.stateToId[b];else{for(;c=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"!=typeof m.idToState[c]||"undefined"!=typeof m.store.idToState[c];);m.stateToId[b]=c,m.idToState[c]=a}return c},m.normalizeState=function(a){var b,c;return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(a.url?a.url:m.getLocationHref()),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&m.options.disableSuid!==!0&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d,e;return e=a.indexOf("#")!=-1?a.split("#")[0]:a,c=/(.*)\&_suid=([0-9]+)$/.exec(e),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c,d,e=null;return b=b||!1,c=m.extractId(a),c&&(e=m.getStateById(c)),e||(d=m.getFullUrl(a),c=m.getIdByUrl(d)||!1,c&&(e=m.getStateById(c)),!e&&b&&!m.isTraditionalAnchor(a)&&(e=m.createStateObject(null,null,d))),e},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b,c=!1;return b=m.extractState(a.url),c=b&&b.id!==a.id},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b,c,d,e=!1;return m.savedStates.length&&(b=a.id,c=m.getLastSavedState(),d=c.id,e=b===d),e},m.saveState=function(a){return!m.isLastSavedState(a)&&(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:a<0?m.savedStates[m.savedStates.length+a]:m.savedStates[a]},m.getCurrentIndex=function(){var a=null;return a=m.savedStates.length<1?0:m.savedStates.length-1},m.getHash=function(a){var b,c=m.getLocationHref(a);return b=m.getHashByUrl(c)},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=decodeURIComponent(b)},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(m.busy(!0),c=m.extractState(a,!0),c&&!m.emulated.pushState?m.pushState(c.data,c.title,c.url,!1):m.getHash()!==a&&(m.bugs.setHash?(e=m.getPageUrl(),m.pushState(null,null,e+"#"+a,!1)):d.location.hash=a),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.encodeURIComponent(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b)},m.setTitle=function(a){var b,c=a.title;c||(b=m.getStateByIndex(0),b&&b.url===a.url&&(c=b.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=c.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(a){}return d.title=c,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b,c=m.extractState(m.getLocationHref());if(!m.isLastSavedState(c))return b=c,b||(b=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;c<=a;++c)m.forward(b);else{if(!(a<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var p=function(){};m.pushState=m.pushState||p,m.replaceState=m.replaceState||p}else m.onPopState=function(b,c){var d,e,f=!1,g=!1;return m.doubleCheckComplete(),d=m.getHash(),d?(e=m.extractState(d||m.getLocationHref(),!0),e?m.replaceState(e.data,e.title,e.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(f=m.Adapter.extractEventData("state",b,c)||!1,g=f?m.getStateById(f):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(m.getLocationHref()),g||(g=m.createStateObject(null,null,m.getLocationHref())),m.expectedStateId=!1,m.isLastSavedState(g)?(m.busy(!1),!1):(m.storeState(g),m.saveState(g),m.setTitle(g),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(a){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(m.getLocationHref(),!0))),f&&(m.onUnload=function(){var a,b,c;try{a=k.parse(f.getItem("History.store"))||{}}catch(b){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a,m.normalizeStore(),c=k.stringify(a);try{f.setItem("History.store",c)}catch(a){if(a.code!==DOMException.QUOTA_EXCEEDED_ERR)throw a;f.length&&(f.removeItem("History.store"),f.setItem("History.store",c))}},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),"Apple Computer, Inc."!==e.vendor&&"Mozilla"!==(e.appCodeName||"")||(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))},(!m.options||!m.options.delayInit)&&m.init()}(window),/**
 * History.js Native Adapter
 * @author Benjamin Arthur Lupton <contact@balupton.com>
 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
 */
function(a,b){"use strict";var c=a.History=a.History||{};if("undefined"!=typeof c.Adapter)throw new Error("History.js Adapter has already been loaded...");c.Adapter={handlers:{},_uid:1,uid:function(a){return a._uid||(a._uid=c.Adapter._uid++)},bind:function(a,b,d){var e=c.Adapter.uid(a);c.Adapter.handlers[e]=c.Adapter.handlers[e]||{},c.Adapter.handlers[e][b]=c.Adapter.handlers[e][b]||[],c.Adapter.handlers[e][b].push(d),a["on"+b]=function(a,b){return function(d){c.Adapter.trigger(a,b,d)}}(a,b)},trigger:function(a,b,d){d=d||{};var e,f,g=c.Adapter.uid(a);for(c.Adapter.handlers[g]=c.Adapter.handlers[g]||{},c.Adapter.handlers[g][b]=c.Adapter.handlers[g][b]||[],e=0,f=c.Adapter.handlers[g][b].length;e<f;++e)c.Adapter.handlers[g][b][e].apply(this,[d])},extractEventData:function(a,c){var d=c&&c[a]||b;return d},onDomLoad:function(b){var c=a.setTimeout(function(){b()},2e3);a.onload=function(){clearTimeout(c),b()}}},"undefined"!=typeof c.init&&c.init()}(window),/*
 * Copyright (c) 2011, Lyon Bros Enterprises, LLC. (http://www.lyonbros.com)
 *
 * Licensed under The MIT License.
 * Redistributions of files must retain the above copyright notice.
 */
function(){"use strict";var a=this;a.Composer||(a.Composer={exp0rt:function(b){Object.keys(b).forEach(function(c){a.Composer[c]=b[c]})}});var b=function(a,b,c){return c.success()},c=function(){var a=1;return function(b){return"c"+a++}}(),d=function(a,b,c){return function(d){a?a(b,d,c):this.fire_event("error",c,b,d,c)}},e=function(a,b){if(a===b)return!0;if(a instanceof Function)return!1;if(typeof a!=typeof b)return!1;if(a&&a.constructor&&!b||!b.constructor)return!1;if(b&&b.constructor&&!a||!a.constructor)return!1;if(a&&b&&a.constructor!=b.constructor)return!1;if(a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)){if(a.length!=b.length)return!1;for(var c=0,d=a.length;c<d;c++){if(!b.hasOwnProperty(c))return!1;if(!e(a[c],b[c]))return!1}}else if(a instanceof Object){for(var f in b)if(b.hasOwnProperty(f)&&!a.hasOwnProperty(f))return!1;for(var f in a)if(a.hasOwnProperty(f)){if(!b.hasOwnProperty(f))return!1;if(a[f]!==b[f]){if("object"!=typeof a[f])return!1;if(!e(a[f],b[f]))return!1}}}else if(a!=b)return!1;return!0},f=function(b,c){var d=b.extend;b.extend=function(b,e){e||(e=this);var f=e.prototype;c.forEach(function(a){b[a]=Composer.object.merge({},f[a],b[a])});var g=d.call(e,b);return a.Composer.merge_extend(g,c),g}},g={erase:function(a,b){for(var c=a.length-1;c>=0;c--)a[c]===b&&a.splice(c,1)},is:function(){return"isArray"in Array?Array.isArray:function(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}}()},h={each:function(a,b,c){a&&(c||(c=this),Object.keys(a).forEach(function(d){b.bind(c)(a[d],d)}))},clone:function(a,b){if(b||(b={}),b.deep)return JSON.parse(JSON.stringify(a));var c={};return Object.keys(a).forEach(function(b){c[b]=a[b]}),c},merge:function(a,b){var c=Array.prototype.slice.call(arguments,1);return c.forEach(function(b){b&&Object.keys(b).forEach(function(c){a[c]=b[c]})}),a},set:function(a,b,c){a||(a={});for(var d=b.split("."),e=a,f=0,g=d.length;f<g;f++){var h=d[f];if(f==g-1){e[h]=c;break}e[h]?("object"!=typeof e||Composer.array.is(e))&&(e[h]={}):e[h]={},e=e[h]}return a},get:function(a,b){a||(a={});for(var c=b.split("."),d=a,e=0,f=c.length;e<f;e++){var g=c[e],h=typeof d[g];if("undefined"==h)return d[g];d=d[g]}return d}},i=function(b){b||(b={});var c=function(c){return function(d){var e=arguments[1]||{},f=e.options_idx||0,g=e.names||["success","error"],h=Composer[c].prototype[d];a.Composer[c].prototype[d]=function(){var a=Array.prototype.slice.call(arguments,0);if(a.length<f){var e=new Array(f);a.forEach(function(a,b){e[b]=a}),a=e}a[f]||(a[f]={});var i=this,j=a[f];return j.promisified?h.apply(i,a):(b.warn&&(j[g[0]]||j[g[1]])&&console.warn("Composer: promisify: attempting to pass callbacks to promisified function: ",c,d),new Promise(function(b,c){g[0]&&(j[g[0]]=b),g[1]&&(j[g[1]]=function(a,b){c(b)}),j.promisified=!0,h.apply(i,a)}))}}},d=c("Collection");["fetch","save","destroy"].forEach(c("Model")),["fetch"].forEach(d),d("reset_async",{options_idx:1,names:["complete"]})};this.Composer.exp0rt({sync:b,cid:c,wrap_error:d,eq:e,merge_extend:f,array:g,object:h,promisify:i})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";function a(a){return h.extend(a)}var b=function(a){if(null==a)return"null";var b=typeof a;return"object"!=b?b:Array.isArray&&Array.isArray(a)?"array":"[object Array]"===Object.prototype.toString.call(a)?"array":b},c=function(a,b,c){c||(c={});for(var d in b)b.hasOwnProperty(d)&&(c.transform&&c.transform(a,b,d),a[d]=b[d]);return a},d=function(a,b,c){return function(){this.$state.parents[c]||(this.$state.parents[c]=[]),this.$state.parents[c].push(b),this.$state.fn.push(c);var d=a.apply(this,arguments);return this.$state.fn.pop(),this.$state.parents[c].pop(),d}},e=function(a,b){return c(a,b,{transform:function(a,b,c){return"function"==typeof a[c]&&!a[c].prototype.$parent&&"function"==typeof b[c]&&!b[c].prototype.$parent&&(b[c]=d(b[c],a[c],c),void(b[c].$parent=a[c]))}})},f=function(a){for(var d in a){var e=a[d];switch(b(e)){case"object":a[d]=f(c({},e));break;case"array":a[d]=e.slice(0)}}return a},g=function(a){a.$initializing=!0;var b=new a;delete a.$initializing;var c=function(){return f(this),c.$initializing?this:(this.$state={parents:{},fn:[]},this.initialize?this.initialize.apply(this,arguments):this)};return c.$constructor=b.$constructor=c,c.prototype=b,c.prototype.$parent=a,c},h=function(){};h.extend=function(a){var b=this,c=g(b);return e(c.prototype,a),c.extend=h.extend,c.prototype.$get_parent=function(){var a=this.$state.fn[this.$state.fn.length-1];if(!a)return!1;var b=this.$state.parents[a],c=b[b.length-1];return c||!1},c.prototype.parent=function(){var a=this.$get_parent();if(a)return a.apply(this,arguments);throw"Class.js: Bad parent method: "+this.$state.fn[this.$state.fn.length-1]},c},a.extend=a,this.Composer.exp0rt({Class:a})}.apply("undefined"!=typeof exports?exports:this),function(a,b){"use strict";var c=function(a,b){return a+"@"+b},d=Composer.Class({_handlers:{},_handler_names:{},bind:function(a,b,d){if(Composer.array.is(a))return a.forEach(function(a){this.bind(a,b,d)}.bind(this)),this;d&&this.unbind(a,d),this._handlers[a]||(this._handlers[a]=[]);var e=this._handlers[a];return e.push(b),d&&(this._handler_names[c(a,d)]=b),this},bind_once:function(a,b,c){c||(c=null);var d=function(){this.unbind(a,d),b.apply(this,arguments)}.bind(this);return this.bind(a,d,c)},unbind:function(a,b){if(!a)return this.wipe();if(Composer.array.is(a))return a.forEach(function(a){this.unbind(a,b)}.bind(this)),this;if(!b)return this.unbind_all(a);var d=b instanceof Function,e=d?null:c(a,b),f=d?b:this._handler_names[e];if(!f)return this;if(d||delete this._handler_names[e],!this._handlers[a])return this;var g=this._handlers[a].indexOf(f);return g<0?this:(this._handlers[a].splice(g,1),this)},unbind_all:function(a){return delete this._handlers[a],this},wipe:function(a){return a||(a={}),this._handlers={},this._handler_names={},this},trigger:function(a,b){var c=Array.prototype.slice.call(arguments,0),d=this._handlers[a]||[],e=this._handlers.all||[];return d.slice(0).forEach(function(a){a.apply(this,c.slice(1))}.bind(this)),e.slice(0).forEach(function(a){a.apply(this,c.slice(0))}.bind(this)),this}});d._make_lookup_name=c,this.Composer.exp0rt({Event:d})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=Composer.Event.extend({__composer_type:"base",options:{},_cid:!1,initialize:function(){this._cid=Composer.cid()},cid:function(){return this._cid},set_options:function(a){a||(a={}),Object.keys(a).forEach(function(b){this.options[b]=a[b]}.bind(this))},fire_event:function(){var a=Array.prototype.slice.call(arguments,0),b=a.shift(),c=a.shift();return c||(c={}),a.unshift(b),c.silent||c.not_silent?c.not_silent&&(c.not_silent==b||c.not_silent.indexOf&&c.not_silent.indexOf(b)>=0)?this.trigger.apply(this,a):c.silent&&("string"==typeof c.silent&&c.silent!=b||c.silent.indexOf&&!(c.silent.indexOf(b)>=0))?this.trigger.apply(this,a):this:this.trigger.apply(this,a)}});this.Composer.exp0rt({Base:a})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=Composer.Base.extend({__composer_type:"model",defaults:{},data:{},_changed:!1,collections:[],id_key:"id",url:!1,base_url:!1,validate:function(a,b){return!1},initialize:function(a,b){a||(a={});var c={},d=function(a,b){c[b]=a};Composer.object.each(Composer.object.clone(this.defaults),d),Composer.object.each(a,d),this.parent(),this.set(c,b),this.init(b)},init:function(){},get:function(a,b){return"undefined"==typeof b&&(b=null),"undefined"==typeof this.data[a]?b:this.data[a]},escape:function(a){var b=this.get(a);return null==b||"string"!=typeof b?b:b.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},has:function(a){return null!=this.data[a]},set:function(a,b){if(b||(b={}),!b.silent&&!this.perform_validation(a,b))return!1;var c=this.changing;return this.changing=!0,Composer.object.each(a,function(a,c){Composer.eq(a,this.data[c])||(this.data[c]=a,this._changed=!0,this.fire_event("change:"+c,b,this,a,b))}.bind(this)),!c&&this._changed&&(this.fire_event("change",b,this,b,a),this._changed=!1),this.changing=!1,this},unset:function(a,b){if(!(a in this.data))return this;b||(b={});var c={};return c[a]=void 0,!(!b.silent&&!this.perform_validation(c,b))&&(delete this.data[a],this._changed=!0,this.fire_event("change:"+a,b,this,void 0,b),this.fire_event("change",b,this,b),this._changed=!1,this)},clear:function(a){a||(a={});var b=this.data,c={};for(var d in b)c[d]=void 0;if(!a.silent&&!this.perform_validation(c,a))return!1;if(this.data={},!a.silent){for(var d in b)this._changed=!0,this.fire_event("change"+d,a,this,void 0,a);this._changed&&(this.fire_event("change",a,this,a),this._changed=!1)}return this},fetch:function(a){a||(a={});var b=a.success;return a.success=function(c){this.set(this.parse(c),a),b&&b(this,c)}.bind(this),a.error=Composer.wrap_error(a.error?a.error.bind(this):null,this,a).bind(this),(this.sync||Composer.sync).call(this,"read",this,a)},save:function(a){if(a||(a={}),!this.perform_validation(this.data,a))return!1;var b=a.success;return a.success=function(c){return!!this.set(this.parse(c),a)&&void(b&&b(this,c))}.bind(this),a.error=Composer.wrap_error(a.error?a.error.bind(this):null,this,a).bind(this),(this.sync||Composer.sync).call(this,this.is_new()?"create":"update",this,a)},destroy:function(a){a||(a={});var b=a.success;return a.success=function(c){this.fire_event("destroy",a,this,this.collections,a),b&&b(this,c)}.bind(this),this.is_new()&&!a.force?a.success():(a.error=Composer.wrap_error(a.error?a.error.bind(this):null,this,a).bind(this),(this.sync||Composer.sync).call(this,"delete",this,a))},parse:function(a){return a},id:function(a){"boolean"!=typeof a&&(a=!1);var b=this.get(this.id_key);return b?b:!a&&this.cid()},is_new:function(){return!this.id(!0)},clone:function(){return new this.$constructor(this.toJSON())},toJSON:function(){return Composer.object.clone(this.data,{deep:!0})},perform_validation:function(a,b){if("function"!=typeof this.validate)return!0;var c=this.validate(a,b);return!c||(b.error?b.error(this,c,b):this.fire_event("error",b,this,c,b),!1)},highest_priority_collection:function(){var a=this.collections.slice(0);return a.sort(function(a,b){return b.priority-a.priority}),!!a.length&&a[0]},get_url:function(){if(this.url)return this.url;if(this.base_url)var a=this.base_url;else{var b=this.highest_priority_collection();if(b)var a=b.get_url();else var a=""}var c=this.id(!0);c=c?"/"+c:"";var d=a?"/"+a.replace(/^\/+/,"").replace(/\/+$/,"")+c:c;return d}});this.Composer.exp0rt({Model:a})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=this,b=Composer.Base.extend({__composer_type:"collection",model:Composer.Model,_models:[],_id_idx:{},_cid_idx:{},sortfn:null,url:"/mycollection",priority:1,initialize:function(b,c,d){c||(c={});for(var e in c)this[e]=c[e];this.parent(),this.model="string"==typeof this.model?a[this.model]:this.model,b&&this.reset(b,d),this.init()},init:function(){},toJSON:function(){return this.models().map(function(a){return a.toJSON()})},models:function(){return this._models},size:function(){return this.models().length},add:function(a,b){if(Composer.array.is(a))return a.forEach(function(a){this.add(a,b)}.bind(this));b||(b={});var c=a instanceof Composer.Model?a:new this.model(a,b);if(c.collections.indexOf(this)==-1&&(c.collections.push(this),b.is_new=!0),this.sortfn){var d=b.at?parseInt(b.at):this.sort_index(c);this._models.splice(d,0,c)}else"number"==typeof b.at?this._models.splice(b.at,0,c):this._models.push(c);return c.bind("all",this._model_event.bind(this,c),"collection:"+this.cid()+":listen:model:all"),this._index_model(c),this.fire_event("add",b,c,this,b),c},remove:function(a,b){if(Composer.array.is(a))return a.slice(0).forEach(function(a){this.remove(a,b)}.bind(this));if(a){b||(b={}),Composer.array.erase(a.collections,this);var c=this._models.length;Composer.array.erase(this._models,a),this._remove_reference(a),this._models.length!=c&&this.fire_event("remove",b,a)}},upsert:function(a,b){if(Composer.array.is(a))return a.forEach(function(a){this.upsert(a,b)}.bind(this));b||(b={});var c=a instanceof Composer.Model?a:new this.model(a,b),d=this.find_by_id(c.id(),b);if(d){var e=this.index_of(d);return"number"==typeof b.at&&e!=b.at&&(this._models.splice(e,1),this._models.splice(b.at,0,d),this.fire_event("sort",b)),d.set(c.toJSON(),Composer.object.merge({},{silent:!0,upsert:!0},b)),this.fire_event("upsert",b,d,b),d}return this.add(c,b),c},clear:function(a){a||(a={});var b=this._models.length;0!=b&&(this.remove(this._models,a),this._models=[],this._models.length!=b&&this.fire_event("clear",a,a))},reset:function(a,b){b||(b={}),b.append||b.upsert||this.clear(b),b.upsert?this.upsert(a,b):this.add(a,b),this.fire_event("reset",b,b)},reset_async:function(a,b){if(b||(b={}),void 0!=a){if(Composer.array.is(a)||(a=[a]),a=a.slice(0),b.append||b.upsert||this.clear(),a.length>0){var c=b.batch||1,d=a.splice(0,c);b.upsert?this.upsert(d,b):this.add(d,b)}return 0==a.length?(this.fire_event("reset",b,b),void(b.complete&&b.complete())):void setTimeout(function(){this.reset_async(a,Composer.object.merge({append:!0},b))}.bind(this),0)}},sort:function(a){return!!this.sortfn&&(this._models.sort(this.sortfn),void this.fire_event("reset",a,a))},sort_index:function(a){if(0==this._models.length)return 0;if(!this.sortfn){var b=this.index_of(a);return b===!1||b<0?this.size():b}for(var c=this._models.slice(0).sort(this.sortfn),d=0;d<c.length;d++){if(a==c[d])return d;if(this.sortfn(c[d],a)>0)return d}var e=c.indexOf(a);return e==c.length-1?e:c.length},parse:function(a){return a},each:function(a,b){b||(b=this),this.models().forEach(a.bind(b))},map:function(a,b){return b||(b=this),this.models().map(a.bind(b))},find:function(a,b){var c=this.models();b&&(c=c.slice(0).sort(b));for(var d=0;d<c.length;d++){var e=c[d];if(a(e))return e}return!1},exists:function(a){for(var b=0;b<this.size();b++)if(a(this.models()[b]))return!0;return!1},find_by_id:function(a,b){b||(b={});var c=this._id_idx[a];return b.fast?c||!1:c||this.find(function(c){return c.id(b.strict)==a||(!(!b.allow_cid||c.cid()!=a)||void 0)})},find_by_cid:function(a,b){b||(b={});var c=this._cid_idx[a];return b.fast?c||!1:c||this.find(function(b){if(b.cid()==a)return!0})},index_of:function(a){for(var b="model"==a.__composer_type?a.id():a,c=0;c<this._models.length;c++)if(this._models[c].id()==b)return c;return!1},filter:function(a,b){return b||(b=this),this._models.filter(a.bind(b))},select:function(a){if("object"==typeof a){var b=a,c=Object.keys(b);a=function(a){for(var d=0;d<c.length;d++){var e=c[d],f=b[e];if(a.get(e)!==f)return!1}return!0}}return this._models.filter(a)},select_one:function(a){var b=this.select(a);return b.length?b[0]:null},first:function(a){var b=this.models();return"undefined"!=typeof a&&0!=parseInt(a)?b.slice(0,a):b[0]},last:function(a){var b=this.models();return"undefined"!=typeof a&&0!=parseInt(a)?b.slice(b.length-a):b[b.length-1]},at:function(a){var b=this._models[a];return b||!1},sort_at:function(a){if(!this.sortfn)return!1;var b=this._models.slice(0).sort(this.sortfn);return b[a]},fetch:function(a){a||(a={});var b=a.success;return a.success=function(c){this.reset(this.parse(c),a),b&&b(this,c)}.bind(this),a.error=Composer.wrap_error(a.error?a.error.bind(this):null,this,a).bind(this),(this.sync||Composer.sync).call(this,"read",this,a)},get_url:function(){return this.url},_index_model:function(a){var b=a.id(!0);b&&(this._unindex_model(a),this._id_idx[b]=a,a._tracked_ids.push(b)),this._cid_idx[a.cid()]=a},_unindex_model:function(a){a._tracked_ids||(a._tracked_ids=[]),a._tracked_ids.forEach(function(a){delete this._id_idx[a]}.bind(this)),delete this._cid_idx[a.cid()]},_remove_reference:function(a){this._unindex_model(a),Composer.array.erase(a.collections,this),a.unbind("all","collection:"+this.cid()+":listen:model:all")},_model_event:function(a,b,c){b=="change:"+a.id_key&&this._index_model(a),"destroy"==b&&this.remove(a,arguments[4]);var d=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,d)}});this.Composer.exp0rt({Collection:b})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=this,b=!!a.Sizzle,c=!!a.jQuery,d=!!a.Slick,e=(!!a.MooTools,function(){if(d)return function(a,b){return a||(a=document),Slick.find(a,b)};if(b)return function(a,b){return a||(a=document),Sizzle.select(b,a)[0]};if(c)return function(a,b){return a||(a=document),jQuery(a).find(b)[0]};if("querySelector"in document){var a=!1;try{document.querySelector(":scope > h1"),a=!0}catch(a){}return function(b,c){return b||(b=document),a&&(c=":scope "+c),b.querySelector(c)}}throw new Error("No selector engine present. Include Sizzle/jQuery or Slick/Mootools before loading composer (or use a modern browser with document.querySelector).")}()),f=function(){if(d)return function(a,b){return a||(a=document),Slick.match(a,b)};if(b)return function(a,b){return a||(a=document),Sizzle.matchesSelector(a,b)};if(c)return function(a,b){return a||(a=document),jQuery(a).is(b)};if("querySelector"in document)return function(a,b){if(a||(a=document),"matches"in a)var c=a.matches;if("msMatchesSelector"in a)var c=a.msMatchesSelector;if("mozMatchesSelector"in a)var c=a.mozMatchesSelector;if("webkitMatchesSelector"in a)var c=a.webkitMatchesSelector;return c.call(a,b)};throw new Error("No selector engine present. Include Sizzle/jQuery or Slick/Mootools before loading composer.")}(),g=function(){return function(a,b,c,d){d?a.addEventListener(b,function(b){b&&window.MooTools&&window.DOMEvent&&(b=new DOMEvent(b));for(var e=b.target||b.srcElement;e;){if(f(e,d)){c.apply(this,[b].concat(b.params||[]));break}e=e.parentNode,e!=a.parentNode&&e!=document.body.parentNode||(e=!1)}}):a.addEventListener(b,function(a){a&&window.MooTools&&window.DOMEvent&&(a=new DOMEvent(a)),c.apply(this,[a].concat(a.params||[]))},!1)}}(),h=function(){return function(a,b,c){a.removeEventListener(b,c,!1)}}(),i=function(){return function(a,b,c){if(c||(c={}),"click"==b&&a.click)return a.click();var d=new CustomEvent(b,c.args);a.dispatchEvent(d)}}(),j=function(a,b){if(!b)return!1;if(f(b,a))return b;var c=b.parentNode;return j(a,c)};this.Composer.exp0rt({find:e,match:f,add_event:g,fire_event:i,remove_event:h,find_parent:j})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=Composer.Base.extend({__composer_type:"controller",_released:!1,_bound_events:[],_subcontrollers:{},el:!1,inject:!1,tag:"div",class_name:!1,elements:{},events:{},initialize:function(a,b){b||(b={});for(var c in a)this[c]=a[c];this.parent(),this._ensure_el(),this.inject&&this.attach(b),this.className&&(this.class_name=this.className),this.class_name&&(this.el.className+=" "+this.class_name),this.refresh_elements(),this.delegate_events(),this.init()},init:function(){},render:function(){return this},html:function(a){this.el||this._ensure_el(),a.appendChild&&a.tagName?(this.el.innerHTML="",this.el.appendChild(a)):this.el.innerHTML=a,this.refresh_elements()},attach:function(a){a||(a={}),this._ensure_el();var b="string"==typeof this.inject?Composer.find(document,this.inject):this.inject;return!!b&&(a.clean_injection&&(b.innerHTML=""),void b.appendChild(this.el))},_with_binder:function(a,b,c,d,e){e||(e=!1);var f=function(){this._released||d.apply(this,arguments)}.bind(this);a.call(b,c,f,e),this._bound_events.push([b,c,f])},with_bind:function(a,b,c,d){return this._with_binder(a.bind,a,b,c,d)},with_bind_once:function(a,b,c,d){return this._with_binder(a.bind_once,a,b,c,d)},track_subcontroller:function(a,b){var c=function(a,b){this._subcontrollers[a]&&(b||this._subcontrollers[a].release(),delete this._subcontrollers[a])}.bind(this);c(a);var d=b();return d.bind("release",function(){c(a,!0)}),this._subcontrollers[a]=d,d},get_subcontroller:function(a){return this._subcontrollers[a]||!1},_ensure_el:function(){"string"==typeof this.el&&(this.el=Composer.find(document,this.el)),this.el||(this.el=document.createElement(this.tag))},release:function(a){a||(a={}),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=!1,this._bound_events.forEach(function(a){var b=a[0],c=a[1],d=a[2];b.unbind(c,d)}),this._bound_events=[],Object.keys(this._subcontrollers).forEach(function(a){this._subcontrollers[a].release()}.bind(this)),this._subcontrollers={},this.fire_event("release",a,this),a.keep_events||this.unbind(),this._released=!0},replace:function(a){return this.el.parentNode&&this.el.parentNode.replaceChild(a,this.el),this.el=a,this.refresh_elements(),this.delegate_events(),a},delegate_events:function(){for(var a in this.events){var b=this[this.events[a]];if("function"==typeof b){b=b.bind(this);var c=a.match(/^(\w+)\s*(.*)$/),d=c[1].trim(),e=c[2].trim();""==e?(Composer.remove_event(this.el,d,b),Composer.add_event(this.el,d,b)):Composer.add_event(this.el,d,b,e)}}},refresh_elements:function(){return!!this.elements&&void Object.keys(this.elements).forEach(function(a){var b=this.elements[a];this[b]=Composer.find(this.el,a)}.bind(this))}});this.Composer.merge_extend(a,["events","elements"]),this.Composer.exp0rt({Controller:a})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=Composer.Controller.extend({__composer_type:"listcontroller",_subcontroller_list:[],_subcontroller_idx:{},_collection:null,_empty:!0,track:function(a,b,c){c||(c={}),this.set_options(c),this._collection=a,a.size()>0&&(this._empty=!1),this.with_bind(a,["clear","add","remove","reset"],function(){var b=0==a.size();this._empty&&!b&&this.trigger("list:notempty"),!this._empty&&b&&this.trigger("list:empty"),this._empty=b}.bind(this)),this.trigger("list:"+(this._empty?"empty":"notempty")),this.with_bind(a,"clear",function(a){this.clear_subcontrollers()}.bind(this)),this.with_bind(a,"add",function(a,c,d){this.add_subcontroller(a,b,d)}.bind(this)),this.with_bind(a,"remove",function(a){this.remove_subcontroller(a)}.bind(this)),c.bind_reset&&this.with_bind(a,"reset",function(a){this.reset_subcontrollers(b,a)}.bind(this)),this.reset_subcontrollers(b)},release:function(){return this.clear_subcontrollers(),this.parent.apply(this,arguments)},index_controller:function(a,b){return!!a&&(this._subcontroller_idx[a.cid()]=b,void this._subcontroller_list.push(b))},unindex_controller:function(a,b){return!!a&&(delete this._subcontroller_idx[a.cid()],void(this._subcontroller_list=this._subcontroller_list.filter(function(a){return a!=b})))},lookup_controller:function(a){return!!a&&this._subcontroller_idx[a.cid()]},clear_subcontrollers:function(){this._subcontroller_list.forEach(function(a){a.release()}),this._subcontroller_list=[],this._subcontroller_idx={}},reset_subcontrollers:function(a,b){this.clear_subcontrollers(),this._collection.each(function(c){this.add_subcontroller(c,a,b)},this)},add_subcontroller:function(a,b,c){var d=b(a,c);this.index_controller(a,d),d.bind("release",function(){this.unindex_controller(a,d)}.bind(this));var e=this._collection.sort_index(a),f=this._collection.sort_at(e-1)||!1,g=this.lookup_controller(f),h=d.el.parentNode;0==e?h.insertBefore(d.el,h.firstChild):g&&g.el.parentNode==h?h.insertBefore(d.el,g.el.nextSibling):h.appendChild(d.el)},remove_subcontroller:function(a){var b=this.lookup_controller(a);return!!b&&(b.release(),void this.unindex_controller(a,b))}});this.Composer.exp0rt({ListController:a})}.apply("undefined"!=typeof exports?exports:this),function(a,b){"use strict";var a=this,c=Composer.Base.extend({__composer_type:"router",last_path:!1,_last_url:null,routes:{},options:{suppress_initial_route:!1,enable_cb:function(a){return!0},process_querystring:!1,base:!1},initialize:function(b,c){if(this.set_options(c),this.routes=b,this.bind("route",this._do_route.bind(this)),a.History||(a.History={enabled:!1}),!History.enabled)throw"History.js is *required* for proper router operation: https://github.com/browserstate/history.js";this.bind("statechange",this.state_change.bind(this)),this.bind_once("destroy",function(){Object.keys(History.Adapter.handlers).forEach(function(a){delete History.Adapter.handlers[a]}),delete a.onstatechange}),History.Adapter.bind(a,"statechange",function(a){a||(a=[this.cur_path()]);var b=a[0],c=a[1];this.trigger("statechange",b,c)}.bind(this)),this.options.suppress_initial_route||History.Adapter.trigger(a,"statechange",[this.cur_path()])},destroy:function(){this.trigger("destroy"),this.unbind()},debasify:function(a){return this.options.base&&0==a.indexOf(this.options.base)&&(a=a.substr(this.options.base.length)),a},cur_path:function(){if(History.emulated.pushState)var b="/"+new String(a.location.hash).toString().replace(/^[#!\/]+/,"");else var b=a.location.pathname+a.location.search;return this.debasify(unescape(b))},get_param:function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+b+"=([^&#]*)"),d=c.exec(a);return null==d?null:decodeURIComponent(d[1].replace(/\+/g," "))},route:function(a,b){a||(a=this.cur_path()),b||(b={}),b.state||(b.state={});var c=this.options.base||"",d=c+"/"+a.trim().replace(/^[a-z]+:\/\/.*?\//,"").replace(/^[#!\/]+/,""),e=c+this.cur_path();e==d?this.trigger("statechange",d,!0):History.emulated.pushState?(History.saveHash(a),window.location.hash="#"+d,this.trigger("statechange",d,!0)):b.replace_state?History.replaceState(b.state,"",d):History.pushState(b.state,"",d)},_do_route:function(b,c){if(!this.options.enable_cb(b))return!1;c||(c=this.routes);var d=this.find_matching_route(b,c);if(!d)return this.trigger("fail",{url:b,route:!1,handler_exists:!1,action_exists:!1});var e=d.route,f=d.args,g=e[0],h=e[1];if("object"!=typeof g){if(!a[g])return this.trigger("fail",{url:b,route:e,handler_exists:!1,action_exists:!1});var g=a[g]}if(!g[h]||"function"!=typeof g[h])return this.trigger("fail",{url:b,route:e,handler_exists:!0,action_exists:!1});var i=f;i.shift(),this._last_url=b,this.trigger("route-success",e),g[h].apply(g,i)},find_matching_route:function(a,b){var a="/"+a.replace(/^!?\//g,""),c=!1,d=[],e=null;for(var f in b)if(e=new RegExp("^"+f.replace(/\//g,"\\/")+"$"),d=e.exec(a)){c=b[f];break}return!!c&&{route:c,args:d,regex:e}},state_change:function(a,c){if(a&&a.stop!=b&&(a=!1),a&&(a=this.debasify(a)),a||(a=this.cur_path()),c=!!c,this.last_path==a&&!c)return!1;this.last_path=a,this.options.process_querystring||(a=a.replace(/\?.*/,"")),a=new String(a);var d={path:a};this.trigger("preroute",d),this.trigger("route",d.path)},last_url:function(){return this._last_url},bind_links:function(b){b||(b={});var c="a";b.selector?c=b.selector:b.exclude_class&&(c='a:not([class~="'+b.exclude_class+'"])');var d=b.bind_element||document.body,e=function(d){if(!d.defaultPrevented&&!(d.ctrlKey||d.shiftKey||d.altKey)){var e=Composer.find_parent(c,d.target),f="undefined"!=typeof d.button?d.button:d.event.button;if(!("_blank"==e.target||f>0||e.href.match(/^javascript:/)||e.href.match(/^mailto:/)||History.emulated.pushState&&""==e.href.replace(/^.*?#/,""))){var g=a.location.host,h=e.href.match(/^[a-z]+:\/\//)?e.href.replace(/[a-z]+:\/\/(.*?)\/.*/i,"$1"):g;if(g==h&&(!b.do_state_change||b.do_state_change(e))){d&&d.preventDefault();var i=e.href.replace(/^[a-z]+:\/\/.*?\//,"").replace(/^[#!\/]+/,"");b.filter_trailing_slash&&(i=i.replace(/\/$/,"")),i="/"+i,this.route(i,{state:b.global_state})}}}}.bind(this);Composer.add_event(d,"click",e,c)}});this.Composer.exp0rt({Router:c})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=this,b=Composer.Model.extend({relations:!1,relation_data:{},skip_relational_serialize:!1,initialize:function(b,c){return c||(c={}),this.relations&&Composer.object.each(this.relations,function(b,c){if(b.model&&"string"==typeof b.model)b.model=Composer.object.get(a,b.model);else if(b.collection&&"string"==typeof b.collection)b.collection=Composer.object.get(a,b.collection);else if(b.filter_collection&&"string"==typeof b.filter_collection){b.filter_collection=Composer.object.get(a,b.filter_collection);var d=b.master;if("string"==typeof d){var e=b.master;b.master=function(){var a=Composer.object.get(this.relation_data,e);return a||(a=new this.relations[e].collection,Composer.object.set(this.relation_data,e)),a}.bind(this),b.master()}}if(!b.delayed_init){this._create_obj(b,c,{set_parent:!0})}},this),this.parent(b,c)},toJSON:function(a){a||(a={});var b=this.parent();return a.raw?b:(this.skip_relational_serialize||a.skip_relational?Object.keys(this.relations).forEach(function(a){delete b[a]}):Object.keys(this.relations).forEach(function(a){var c=Composer.object.get(this.relation_data,a);c&&Composer.object.set(b,a,c.toJSON())}.bind(this)),b)},set:function(a,b){return b||(b={}),this.relations&&!b.skip_relational&&Composer.object.each(this.relations,function(c,d){var e=Composer.object.get(a,d);if("undefined"!=typeof e){var f=Composer.object.clone(b);f.data=e;this._create_obj(c,d,f)}},this),this.parent(a,b)},get:function(a,b){var c=Composer.object.get(this.relation_data,a);return"undefined"!=typeof c?c:this.parent(a,b)},clear:function(a){return a||(a={}),this.relations&&!a.skip_relational&&Composer.object.each(this.relations,function(a,b){var c=Composer.object.get(this.relation_data,b);"undefined"!=typeof c&&c.clear&&"function"==typeof c.clear&&c.clear()},this),this.parent.apply(this,arguments)},bind_relational:function(a){var b=this.relations[a];if(!b)return!1;var c=this._create_obj(b,a),d=Array.prototype.slice.call(arguments,0);c.bind.apply(c,d.slice(1))},unbind_relational:function(a){var b=this.relations[a];if(!b)return!1;var c=Composer.object.get(this.relation_data,a);if(!c)return!1;var d=Array.prototype.slice.call(arguments,0);c.unbind.apply(c,d.slice(1))},set_parent:function(a,b){b.get_parent=function(){return a}},get_parent:function(a){return a.get_parent()},_create_obj:function(a,b,c){c||(c={});var d=c.data;if(delete c.data,d&&d.__composer_type&&""!=d.__composer_type)var e=d;else{var e=Composer.object.get(this.relation_data,b),f=a.collection||a.filter_collection?"collection":"model";switch(f){case"model":e||(e=new a.model),c.set_parent&&this.set_parent(this,e),d&&e.set(d,c);break;case"collection":e||(a.collection?e=new a.collection:a.filter_collection&&(e=new a.filter_collection(a.master(),Composer.object.merge({skip_initial_sync:!0},a.options)))),c.set_parent&&this.set_parent(this,e),d&&e.reset(d,c)}}return Composer.object.set(this.relation_data,b,e),this.trigger("relation",e,b),this.trigger("relation:"+b,e),e}});this.Composer.merge_extend(b,["relations"]),this.Composer.exp0rt({HasOne:-1,HasMany:-1,RelationalModel:b})}.apply("undefined"!=typeof exports?exports:this),function(){"use strict";var a=Composer.Collection.extend({__composer_type:"filtercollection",master:null,filter:function(){return!0},transform:null,limit:!1,options:{forward_all_events:!1,refresh_on_change:!1,sort_event:!1},initialize:function(a,b){b||(b={});var c=Object.keys(this.options);return Object.keys(b).forEach(function(a){var d=b[a];"function"==typeof d&&(d=d.bind(this)),c.indexOf(a)>=0?this.options[a]=d:this[a]=d}.bind(this)),this.parent(),this.master=a,!!this.master&&(!!this.filter&&(this.attach(b),void(b.skip_initial_sync||this.refresh())))},attach:function(){this.master.bind("all",this.match_action.bind(this),"filtercollection:"+this.cid()+":all"),this.bind("reset",function(a){return a||(a={}),!a.has_reload&&void this.refresh(a)}.bind(this),"filtercollection:reset")},detach:function(){this.master.unbind("all","filtercollection:"+this.cid()+":all"),this.unbind("reset","filtercollection:reset")},match_action:function(a,b){var c=Array.prototype.slice.call(arguments,0);switch(a){case"add":this.add_event(b,{from_event:!0});break;case"reset":this.refresh();break;case"clear":this.clear();break;case"remove":this.remove_event(b,{from_event:!0});break;case"change":this.change_event(b,{},c);break;case"sort":this.refresh();break;default:this.forward_event(a,b,c)}},refresh:function(a){if(a||(a={}),a.diff_events)var b=this._models;if(this._models=this.master._models.filter(function(a){
return this.filter(a,this)}.bind(this)),this.sort({silent:!0}),this.limit&&this._models.splice(this.limit,this._models.length),a.diff_events){var c=function(a,b){return a.filter(function(a){return b.indexOf(a)<0})};c(b,this._models).forEach(function(b){this.fire_event("remove",a,b)},this),c(this._models,b).forEach(function(b){this.fire_event("add",a,b)},this)}this.fire_event("reset",a,{has_reload:!0})},change_event:function(a,b,c){if(b||(b={}),!a||this.models().indexOf(a)<0&&!this.filter(a,this))return!1;var d=this._models.length;if(this.options.refresh_on_change)this.refresh({silent:!0});else{var e=this._models.indexOf(a),f=this.sort_index(a);e==-1&&this.filter(a,this)?this.add(a,b):e>-1&&!this.filter(a,this)?this.remove(a,b):e!=f&&(this.options.sort_event?(this.sort(Composer.object.merge({},b,{silent:!0})),this.fire_event("sort",b)):this.sort(b))}if(this._models.length==d){c.shift();var g=["change",b].concat(c);this.fire_event.apply(this,g)}else this.fire_event("reset",b)},add:function(a,b){if(Composer.array.is(a))return Composer.object.each(a,function(a){this.add(a,b)},this);b||(b={}),"undefined"==typeof b.transform&&(b.transform=!0);var c="model"==a.__composer_type?a:new this.master.model(a,b);if(this.transform&&b.transform&&(c=this.transform.call(this,c,"add")),!this.filter(c,this))return!1;if("number"==typeof b.at){var d=this.at(b.at),e=this.master.index_of(d);e!==!1&&(b.at=e)}return this.master.index_of(c)?this._do_add(c,b):(this.master.add(c,b),this.limit&&this._models.splice(this.limit)),c},_do_add:function(a,b){this._models.push(a);var c=this._models.indexOf(a);this.sort({silent:!0});var d=this._models.indexOf(a);this.limit&&this._models.splice(this.limit),this.index_of(a)&&(this.fire_event("add",b,a,this,b),c!=d&&(this.options.sort_event?this.fire_event("sort",b):this.fire_event("reset",b)))},remove:function(a,b){return Composer.array.is(a)?Composer.object.each(a,function(a){this.remove(a)},this):(b||(b={}),"undefined"==typeof b.transform&&(b.transform=!0),!(this._models.indexOf(a)<0)&&(this.transform&&b.transform&&(a=this.transform.call(this,a,"remove")),Composer.array.erase(this._models,a),this.fire_event("remove",b,a),void this._remove_reference(a)))},add_event:function(a,b){return!!this.filter(a,this)&&(this.refresh({silent:!0}),this.options.sort_event&&this.fire_event("sort",b),void this.fire_event("add",b,a,this,b))},remove_event:function(a,b){return!(this._models.indexOf(a)<0)&&(this.refresh({silent:!0}),void this.fire_event("remove",b,a))},forward_event:function(a,b,c){return!!this.options.forward_all_events&&(!(b&&"model"==b.__composer_type&&!this.filter(b,this))&&void this.trigger.apply(this,c))}});this.Composer.exp0rt({FilterCollection:a})}.apply("undefined"!=typeof exports?exports:this);